[TOC]

## Servlet生命周期
### 1.Servlet中的生命周期方法

#### 1.被创建

**被创建**执行`init()`方法，只执行一次，加载资源

```xml
	<!--配置ServletMethods-->
    <servlet>
        <servlet-name>ServletMethods</servlet-name>
        <servlet-class>org.iqqcode.web.servlet.ServletMethods</servlet-class>
        <!--指定Servle的创建时机(在服务器启动时被创建)
                1.第一次被访问时创建
                    * <load-on-startup>的默认值为-1
                2.在服务器启动时创建
                    * <load-on-startup>的值为0或正整数
         -->
        <load-on-startup>-5</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>ServletMethods</servlet-name>
        <url-pattern>/ServletMethods</url-pattern>
    </servlet-mapping>
```

`<load-on-startup> 1</load-on-startup>`启动时没有创建servlet，在启动后再调用`init()`

`<load-on-startup>-5</load-on-startup>`启动时没有创建servlet，在启动后再调用`init()`

指定Servle的创建时机(在服务器启动时被创建)

- 第一次被访问时创建 `<load-on-startup>`的默认值为-1

- 在服务器启动时创建  `<load-on-startup>`的值为0或正整数

-------------------------------------------------------

Servlet的`init()`方法，只执行一次，说明一个Servlet在内存中只存在一个对象，Servlet是单例的(单例：一个类只能产生一个对象)

那么，为什么Servlet时单例的呢？因为多个用户同时访问时，可能存在线程安全问题。如果同时读，那么数据不会被修改，就没有问题。但是如果A在修改，B在读取，可能就会造成数据不一致的问题。

如何解决呢？

可能大家会想到加锁，但是没法通过**同步方法来**上锁，因为Servlet是定义了一个标准，我们是来实现的，不能再外部修改，在`service()`方法中无法实现。**同步代码块**上锁之后，一次只允许一个对象来访问资源，对于服务器来说性能低下。

解决：

尽量不要在Servlet中定义成员变量，即使定义了成员变量，也不要修改值。

如果将变量定义在方法中，为局部变量，此时对象在栈中，不共享只在此方法中有效。

```java
//提供服务
@Override
public void service(ServletRequest servletRequest, ServletResponse servletResponse) throws  {
  	int num = 0;
		System.out.println("Hello Servlet!");
}
```



#### 2.提供服务

**提供服务**时执行`service()`方法，执行多次。每次访问Servlet时，`service()`方法都会被调用一次



#### 3.被销毁

**Servlet被销毁**(服务器正常关闭)前执行`destroy`方法，只执行一次 ，释放资源



