## 1. Ping涉及到的协议

**DNS**：域名系统（Domain Name System）

**ICMP**：

- 查询报文，`Ping`检测两个目标主机间是否连通
- 差错报告报文，`traceroute`检测源主机到目标主机之间所经过的网关（路由器）数量

**IGMP**：使网络中的主机-向-临近路由器报告它的广播组成员

**IP** ：提供主机与主机间的通信，寻址和路由转发

**ARP** ：已知IP地址寻找MAC地址



## 2. Ping的执行流程

`ping` 命令接收一个IP地址或一个网络域名，如果是域名会将域名转换为IP地址。

1. **判断被ping的目标主机和源主机是否在一个网络上**。如果不在一个网络上，则查找路由表，找到通往目标网络的路由器IP地址或默认网关IP地址。

2. 查找本地主机ARP表中是否有该**IP对应的MAC地址**；如果没有，则通过广播询问该IP的MAC地址；本网络中的主机、路由器都会接收到该询问报文

3. 查询到目的主机的MAC地址后，`ping`命令使用ICMP协议封装含有对端MAC地址的IP数据报交给交换机，交换机查找自己的MAC与port端口对应表，将数据包传给对应端口的主机